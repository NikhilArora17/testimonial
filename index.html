<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Testimonials</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300&display=swap" rel="stylesheet">
<style>
  :root{
    --muted:#B1B5C0; --emph:#454E59;
    --frame-w:1439px; --frame-h:521px; --left-inset:156px;
    --heading-size:40px;

    --img-w:394px; --img-h:341px;
    --img-to-group-gap:42px;

    --quote-to-text-gap:26px;
    --text-to-meta-gap:86px;
    --meta-to-dots-gap:86px;

    --dot-w:40px; --dot-h:8px;

    --slide-ms:1000ms;
    --interval-ms:3500ms;

    /* Animation */
    --enter-dur:1.5s;
    --enter-ease:cubic-bezier(.22,.61,.36,1);
  }

  *{box-sizing:border-box}
  html,body{margin:0;background:#fff;color:#000}
  body{font-family:Manrope,system-ui,-apple-system,Segoe UI,Roboto,sans-serif}

  .frame{
    width:var(--frame-w); height:var(--frame-h);
    background:#fff; margin:0 auto; position:relative; overflow:hidden;
  }
  .inner{
    position:absolute; inset:0;
    padding-left:var(--left-inset);
    padding-right:var(--left-inset);
    display:flex; flex-direction:column;
  }

  .heading{
    margin:0 0 48px 0;
    font-size:var(--heading-size); line-height:1.1;
    font-weight:300; letter-spacing:.02em; color:var(--muted);
  }
  .heading em{font-style:normal; color:var(--emph);}

  .viewport{
    flex:1; overflow-x:hidden; overflow-y:hidden;
    width:calc(var(--frame-w) - (var(--left-inset) * 2));
  }
  .track{
    display:flex; height:100%;
    transition:transform var(--slide-ms) cubic-bezier(.25,.1,.25,1);
    will-change:transform;
  }

  .slide{
    flex:0 0 100%; height:100%;
    display:flex; align-items:flex-start; gap:var(--img-to-group-gap);
  }

  .photo{
    width:var(--img-w); height:var(--img-h);
    background:#eee; overflow:hidden; align-self:flex-start;
  }
  .photo img{
    width:100%; height:100%;
    object-fit:cover;
    object-position:50% 18%;
    filter:grayscale(100%);
  }

  .group{
    position:relative;
    width:calc(var(--frame-w) - (var(--left-inset) * 2) - var(--img-w) - var(--img-to-group-gap));
    height:var(--img-h);
    overflow:hidden; /* ensures off-screen starts are clipped */
  }

  .quoteMark{
    font-weight:300; font-size:64px; line-height:1;
    transform:translateX(-5px);
    margin:0; height:33px; overflow:hidden;
    display:flex; align-items:flex-start;
  }

  .text{
    margin-top:var(--quote-to-text-gap);
    max-width:100%; font-weight:300; font-size:14px; line-height:1.6;
    padding-left:0px;
  }

  .meta{
    position:absolute; left:0;
    bottom:calc(var(--meta-to-dots-gap) + var(--dot-h));
    font-size:14px; font-weight:300; color:#000; line-height:1.3;
  }
  .meta strong, .meta .role{
    display:inline; margin:0; padding:0; line-height:1.3; color:#000;
  }

  .dots{
    position:absolute; left:0; bottom:0;
    width:100%;
    display:flex; justify-content:flex-start; align-items:center; gap:10px;
  }
  .dot{
    position:relative; width:10px; height:12px; border:0;
    background:#d3d3d3; border-radius:100%;
    cursor:pointer; transition:background .3s ease; overflow:hidden;
  }
  .dot.active{
    width:75px; height:12px; border-radius:100px; background:#d3d3d3;
  }
  .dot.active::after{
    content:""; position:absolute; left:0; top:0; bottom:0; width:0%;
    background:#454E59; border-radius:5px;
  }
  .dot.playing::after{ animation: dotfill var(--interval-ms) linear forwards; }

  @keyframes dotfill{ from{width:0%} to{width:100%} }

  /* =========================
     Entrance animation
     ========================= */
  .will-enter-left{ opacity:0; transform:translateX(-100%); }
  .enter-left{
    opacity:1; transform:translateX(0);
    transition:transform var(--enter-dur) var(--enter-ease), opacity var(--enter-dur) var(--enter-ease);
  }

  .will-enter-right{ opacity:0; transform:translateX(100%); }
  /* Meta travels farther to guarantee full off-screen start */
  .meta.will-enter-right{ transform:translateX(250%); } /* NEW */

  .enter-right{
    opacity:1; transform:translateX(0);
    transition:transform var(--enter-dur) var(--enter-ease), opacity var(--enter-dur) var(--enter-ease);
  }

  .will-reveal-bottom{ opacity:0; transform:translateY(100%); clip-path: inset(100% 0 0 0); }
  .reveal-bottom{
    opacity:1; transform:translateY(0); clip-path: inset(0 0 0 0);
    transition:clip-path var(--enter-dur) var(--enter-ease), transform var(--enter-dur) var(--enter-ease), opacity var(--enter-dur) var(--enter-ease);
  }

  @media (prefers-reduced-motion: reduce){
    .will-enter-left, .will-enter-right, .will-reveal-bottom{opacity:1; transform:none; clip-path:none}
    .enter-left, .enter-right, .reveal-bottom{transition:none}
  }
</style>
</head>
<body>
<div class="frame" id="testimonial-frame">
  <div class="inner">
    <div class="heading will-enter-left" id="heading">WHAT OUR CLIENTS<br>ARE <em>SAYING</em></div>
    <div class="viewport" id="viewport">
      <div class="track" id="track"></div>
    </div>
  </div>
</div>

<script>
const track = document.getElementById('track');
const viewport = document.getElementById('viewport');

const TRANSITION_MS = 1000;
const AUTOPLAY_MS   = 3500;
const ENTER_MS      = 1500; // must match --enter-dur

let idx = 0, timer = null;
let autoplayRunning = false; // gates dot fill

const slides = [
  { img: 'public/1.jpg',
    quote: 'Our Elysium Cinema, brought to life by MCBEE within our residence at DLF Camellias, Gurugram, is nothing short of extraordinary. They created an immersive cinematic environment that marries elegance and cutting-edge AV performance.',
    name: 'KP Singh', role: 'Chairman at DLF' },
  { img: 'public/2.jpg',
    quote: 'MCBEE transformed our auditorium with flawless sound, crystal-clear visuals, and seamless controls. Every event now feels world-class.',
    name: 'Satya Nadella', role: 'CEO at Microsoft' },
  { img: 'public/3.jpg',
    quote: 'Working with MCBEE transformed our flagship store into an immersive sensory experience. The lighting, signage screens, and background audio now create a perfect ambiance that reflects our brand story. Shopper engagement has noticeably increased.',
    name: 'Ravi K.', role: 'CEO at INDIA TV' }
];

function build(){
  track.innerHTML = slides.map((s, i) => `
    <section class="slide">
      <div class="photo ${i===0?'will-reveal-bottom':''}"><img src="${s.img}" alt="${s.name}"></div>
      <div class="group">
        <div class="quoteMark ${i===0?'will-enter-right':''}">â€œ</div>
        <div class="text ${i===0?'will-enter-right':''}">${s.quote}</div>
        <div class="meta ${i===0?'will-enter-right':''}"><strong>${s.name}</strong><br><span class="role">${s.role}</span></div>
        <div class="dots ${i===0?'will-enter-right':''}" data-dots="${i}">
          ${slides.map((_, k)=> `<button class="dot ${k===0?'active':''}" aria-label="Go to slide ${k+1}"></button>`).join('')}
        </div>
      </div>
    </section>
  `).join('');

  document.querySelectorAll('.dots .dot').forEach((btn, k)=>{ btn.addEventListener('click', ()=> go(k, true)); });

  go(0,false);            // set the first slide, but DON'T start autoplay yet
  setupEntranceOnce();    // will call start() after ENTER_MS
}

function updateDots(){
  document.querySelectorAll('.dots .dot').forEach(d=>{
    d.classList.remove('active','playing');
    d.style.animation = 'none';
  });
  document.querySelectorAll('.dots').forEach(row=>{
    const dots = row.querySelectorAll('.dot');
    const active = dots[idx];
    if (!active) return;
    active.classList.add('active');
    if (autoplayRunning){
      active.classList.remove('playing');
      void active.offsetWidth;
      active.classList.add('playing');
    }
  });
}

function go(i, user=false){
  idx = (i + slides.length) % slides.length;
  track.style.transform = `translateX(-${idx * 100}%)`;
  updateDots();
  if (user) restart();
}

function next(){ go(idx+1,false); }
function start(){
  stop();
  autoplayRunning = true;  // enable dot fill
  updateDots();            // kick the fill animation now
  timer = setInterval(next, AUTOPLAY_MS);
}
function stop(){
  if (timer) clearInterval(timer);
  timer = null;
  autoplayRunning = false; // pause dot fill
}

/* === One-time entrance animation === */
function setupEntranceOnce(){
  const frame = document.getElementById('testimonial-frame');
  const heading = document.getElementById('heading');
  const firstSlide = track.querySelector('.slide');
  const photo = firstSlide.querySelector('.photo');
  const quote = firstSlide.querySelector('.quoteMark');
  const text  = firstSlide.querySelector('.text');
  const meta  = firstSlide.querySelector('.meta');
  const dots  = firstSlide.querySelector('.dots');

  let done = false;

  const io = new IntersectionObserver((entries)=>{
    entries.forEach(entry=>{
      if (done) return;
      if (entry.isIntersecting){
        heading.classList.add('enter-left');
        photo.classList.add('reveal-bottom');
        [quote, text, meta, dots].forEach(el => el.classList.add('enter-right'));

        [heading, quote, text, meta, dots].forEach(el=> el.classList.remove('will-enter-left','will-enter-right'));
        photo.classList.remove('will-reveal-bottom');

        done = true;
        io.unobserve(frame);

        // Wait until entrance settles, THEN start autoplay & dot progress
        setTimeout(()=>{ start(); }, ENTER_MS + 50);
      }
    });
  }, {threshold: 0.25});

  io.observe(frame);
}

window.addEventListener('load', build);
</script>
</body>
</html>
